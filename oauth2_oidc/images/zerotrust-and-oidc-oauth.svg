<svg viewBox="0 0 1000 700" xmlns="http://www.w3.org/2000/svg">
    <defs>
        <linearGradient id="zeroTrustGrad" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color:#1e3a8a;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#3b82f6;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="oauthGrad" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color:#059669;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#10b981;stop-opacity:1" />
        </linearGradient>
        <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
            <feDropShadow dx="2" dy="2" stdDeviation="3" flood-color="#000000" flood-opacity="0.3"/>
        </filter>
    </defs>

    <!-- Background -->
    <rect width="1000" height="700" fill="#f8fafc"/>

    <!-- Title -->
    <text x="500" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#1e293b">
        ゼロトラストアーキテクチャ × OAuth/OIDC
    </text>

    <!-- Zero Trust Principle Banner -->
    <rect x="200" y="50" width="600" height="40" fill="url(#zeroTrustGrad)" rx="20" filter="url(#shadow)"/>
    <text x="500" y="75" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white">
        Never Trust, Always Verify（決して信頼せず、常に検証する）
    </text>

    <!-- Central Identity Core -->
    <circle cx="500" cy="350" r="80" fill="url(#zeroTrustGrad)" filter="url(#shadow)"/>
    <text x="500" y="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white">
        アイデンティティ
    </text>
    <text x="500" y="360" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="white">
        （新たな境界）
    </text>

    <!-- OAuth/OIDC Ring -->
    <circle cx="500" cy="350" r="140" fill="none" stroke="url(#oauthGrad)" stroke-width="8" stroke-dasharray="10,5"/>
    <text x="500" y="200" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#059669">
        OAuth/OIDC Layer
    </text>

    <!-- OAuth/OIDC Functions -->
    <!-- Strong Authentication -->
    <g transform="translate(300,280)">
        <rect x="-60" y="-20" width="120" height="40" fill="#f59e0b" rx="20" filter="url(#shadow)"/>
        <text x="0" y="-5" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">
            強力な認証基盤
        </text>
        <text x="0" y="10" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">
            MFA/パスキー
        </text>
    </g>

    <!-- Dynamic Access Policy -->
    <g transform="translate(700,280)">
        <rect x="-60" y="-20" width="120" height="40" fill="#8b5cf6" rx="20" filter="url(#shadow)"/>
        <text x="0" y="-5" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">
            動的アクセス
        </text>
        <text x="0" y="10" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">
            ポリシー
        </text>
    </g>

    <!-- Continuous Evaluation -->
    <g transform="translate(300,420)">
        <rect x="-60" y="-20" width="120" height="40" fill="#ec4899" rx="20" filter="url(#shadow)"/>
        <text x="0" y="-5" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">
            継続的評価
        </text>
        <text x="0" y="10" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">
            CAEP/SSF
        </text>
    </g>

    <!-- API Security -->
    <g transform="translate(700,420)">
        <rect x="-60" y="-20" width="120" height="40" fill="#06b6d4" rx="20" filter="url(#shadow)"/>
        <text x="0" y="-5" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">
            APIセキュリティ
        </text>
        <text x="0" y="10" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">
            OAuth保護
        </text>
    </g>

    <!-- External Elements -->
    <!-- User -->
    <g transform="translate(100,150)">
        <circle cx="0" cy="0" r="30" fill="#64748b" filter="url(#shadow)"/>
        <text x="0" y="5" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">
            ユーザー
        </text>
        <text x="0" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#64748b">
            内外問わず検証
        </text>
    </g>

    <!-- Device -->
    <g transform="translate(900,150)">
        <rect x="-25" y="-15" width="50" height="30" fill="#64748b" rx="5" filter="url(#shadow)"/>
        <text x="0" y="5" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">
            デバイス
        </text>
        <text x="0" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#64748b">
            信頼性検証
        </text>
    </g>

    <!-- APIs/Services -->
    <g transform="translate(100,550)">
        <rect x="-30" y="-15" width="60" height="30" fill="#64748b" rx="5" filter="url(#shadow)"/>
        <text x="0" y="5" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">
            API/サービス
        </text>
        <text x="0" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#64748b">
            全アクセス検証
        </text>
    </g>

    <!-- PDP/PEP -->
    <g transform="translate(900,550)">
        <rect x="-30" y="-15" width="60" height="30" fill="#64748b" rx="5" filter="url(#shadow)"/>
        <text x="0" y="-5" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="white">
            PDP/PEP
        </text>
        <text x="0" y="8" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">
            ポリシー決定
        </text>
        <text x="0" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#64748b">
            アクセス制御
        </text>
    </g>

    <!-- Context Factors -->
    <g transform="translate(500,520)">
        <rect x="-80" y="-25" width="160" height="50" fill="#f3f4f6" stroke="#9ca3af" stroke-width="2" rx="10"/>
        <text x="0" y="-10" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#374151">
            コンテキスト要素
        </text>
        <text x="0" y="5" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#6b7280">
            時間・場所・デバイス状態・行動パターン
        </text>
    </g>

    <!-- Arrows showing flow -->
    <!-- User to Identity -->
    <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#059669" />
        </marker>
    </defs>

    <path d="M 130 180 Q 300 250 420 320" fill="none" stroke="#059669" stroke-width="3" marker-end="url(#arrowhead)"/>
    <path d="M 870 180 Q 700 250 580 320" fill="none" stroke="#059669" stroke-width="3" marker-end="url(#arrowhead)"/>
    <path d="M 130 520 Q 300 450 420 380" fill="none" stroke="#059669" stroke-width="3" marker-end="url(#arrowhead)"/>
    <path d="M 870 520 Q 700 450 580 380" fill="none" stroke="#059669" stroke-width="3" marker-end="url(#arrowhead)"/>

    <!-- Verification arrows -->
    <path d="M 500 430 Q 500 470 500 495" fill="none" stroke="#dc2626" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>

    <!-- Legend -->
    <g transform="translate(50,620)">
        <rect x="0" y="0" width="300" height="70" fill="white" stroke="#e5e7eb" stroke-width="1" rx="5"/>
        <text x="10" y="20" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#374151">
            凡例:
        </text>
        <circle cx="20" cy="35" r="5" fill="url(#zeroTrustGrad)"/>
        <text x="35" y="40" font-family="Arial, sans-serif" font-size="12" fill="#374151">
            ゼロトラスト核心部
        </text>
        <circle cx="20" cy="55" r="5" fill="url(#oauthGrad)"/>
        <text x="35" y="60" font-family="Arial, sans-serif" font-size="12" fill="#374151">
            OAuth/OIDC機能
        </text>
        <line x1="160" y1="35" x2="180" y2="35" stroke="#059669" stroke-width="3" marker-end="url(#arrowhead)"/>
        <text x="190" y="40" font-family="Arial, sans-serif" font-size="12" fill="#374151">
            認証・認可フロー
        </text>
        <line x1="160" y1="55" x2="180" y2="55" stroke="#dc2626" stroke-width="2" stroke-dasharray="5,5"/>
        <text x="190" y="60" font-family="Arial, sans-serif" font-size="12" fill="#374151">
            継続検証
        </text>
    </g>
</svg>