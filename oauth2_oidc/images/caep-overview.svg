<svg viewBox="0 0 1000 700" xmlns="http://www.w3.org/2000/svg">
    <!-- Background -->
    <rect width="1000" height="700" fill="#f8f9fa"/>

    <!-- Title -->
    <text x="500" y="40" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#2c3e50">
        CAEP (Continuous Access Evaluation Protocol) 概要
    </text>

    <!-- Traditional vs CAEP comparison -->
    <text x="250" y="80" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#e74c3c">
        従来の静的認証
    </text>
    <text x="750" y="80" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#27ae60">
        CAEP (動的認証)
    </text>

    <!-- Traditional Authentication -->
    <rect x="50" y="100" width="400" height="250" fill="#ffeaea" stroke="#e74c3c" stroke-width="2" rx="10"/>

    <!-- User login traditional -->
    <circle cx="100" cy="140" r="20" fill="#3498db"/>
    <text x="100" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">👤</text>
    <text x="130" y="145" font-family="Arial, sans-serif" font-size="14">ユーザー</text>

    <!-- Arrow to IdP -->
    <path d="M 150 140 Q 200 120 250 140" stroke="#666" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
    <text x="200" y="125" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#666">ログイン</text>

    <!-- IdP traditional -->
    <rect x="250" y="120" width="80" height="40" fill="#e67e22" rx="5"/>
    <text x="290" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">IdP</text>

    <!-- Token issued -->
    <path d="M 290 160 Q 290 180 290 200" stroke="#e67e22" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
    <text x="320" y="180" font-family="Arial, sans-serif" font-size="12" fill="#e67e22">トークン発行</text>

    <!-- Token validity -->
    <rect x="200" y="200" width="180" height="30" fill="#f39c12" rx="5"/>
    <text x="290" y="220" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">トークン有効期限まで継続</text>

    <!-- Problem indicator -->
    <circle cx="150" cy="270" r="15" fill="#e74c3c"/>
    <text x="150" y="275" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">⚠️</text>
    <text x="180" y="275" font-family="Arial, sans-serif" font-size="12" fill="#e74c3c">セキュリティイベント発生</text>

    <!-- Still valid indicator -->
    <text x="290" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#e74c3c">
        ⚠️ トークンは依然として有効
    </text>
    <text x="290" y="320" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#c0392b">
        セキュリティリスクが継続
    </text>

    <!-- CAEP Authentication -->
    <rect x="550" y="100" width="400" height="500" fill="#eafaf1" stroke="#27ae60" stroke-width="2" rx="10"/>

    <!-- Components in CAEP -->
    <!-- User -->
    <circle cx="600" cy="140" r="20" fill="#3498db"/>
    <text x="600" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">👤</text>
    <text x="630" y="145" font-family="Arial, sans-serif" font-size="14">ユーザー</text>

    <!-- IdP CAEP -->
    <rect x="750" y="120" width="80" height="40" fill="#27ae60" rx="5"/>
    <text x="790" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">IdP</text>

    <!-- Resource Server -->
    <rect x="580" y="200" width="100" height="40" fill="#8e44ad" rx="5"/>
    <text x="630" y="220" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">リソースサーバー</text>

    <!-- Security Event Transmitter -->
    <rect x="720" y="200" width="120" height="40" fill="#f39c12" rx="5"/>
    <text x="780" y="215" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">セキュリティ</text>
    <text x="780" y="230" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">イベント発信者</text>

    <!-- CAEP Flow -->
    <!-- 1. Initial authentication -->
    <path d="M 650 140 Q 700 120 750 140" stroke="#27ae60" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
    <text x="700" y="125" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#27ae60">①認証</text>

    <!-- 2. Token to resource -->
    <path d="M 620 160 Q 620 180 620 200" stroke="#8e44ad" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
    <text x="650" y="180" font-family="Arial, sans-serif" font-size="10" fill="#8e44ad">②アクセス</text>

    <!-- 3. Security Event -->
    <circle cx="780" cy="280" r="15" fill="#e74c3c"/>
    <text x="780" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">⚠️</text>
    <text x="780" y="305" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#e74c3c">セキュリティイベント検知</text>

    <!-- 4. CAEP Event transmission -->
    <path d="M 780 240 Q 780 260 780 280" stroke="#e74c3c" stroke-width="3" fill="none"/>
    <path d="M 765 280 Q 740 290 720 300" stroke="#e74c3c" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
    <path d="M 765 280 Q 740 270 720 260" stroke="#e74c3c" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>

    <text x="700" y="275" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#e74c3c">③CAEPイベント送信</text>

    <!-- 5. Immediate revocation -->
    <rect x="580" y="350" width="260" height="40" fill="#e74c3c" rx="5"/>
    <text x="710" y="375" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">④即座にアクセス無効化</text>

    <!-- Benefits box -->
    <rect x="580" y="420" width="260" height="120" fill="#d5f4e6" stroke="#27ae60" stroke-width="1" rx="5"/>
    <text x="710" y="440" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#27ae60">CAEPの利点</text>

    <text x="590" y="460" font-family="Arial, sans-serif" font-size="12" fill="#2d5016">✓ リアルタイムセキュリティ対応</text>
    <text x="590" y="480" font-family="Arial, sans-serif" font-size="12" fill="#2d5016">✓ ゼロトラストセキュリティ実現</text>
    <text x="590" y="500" font-family="Arial, sans-serif" font-size="12" fill="#2d5016">✓ 複数サービス間での統一的管理</text>
    <text x="590" y="520" font-family="Arial, sans-serif" font-size="12" fill="#2d5016">✓ セキュリティインシデント被害軽減</text>

    <!-- CAEP Events examples -->
    <text x="710" y="570" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#34495e">主要なCAEPイベント例</text>
    <text x="590" y="590" font-family="Arial, sans-serif" font-size="11" fill="#34495e">• アカウント無効化/削除 • パスワード変更 • MFA状態変更</text>
    <text x="590" y="605" font-family="Arial, sans-serif" font-size="11" fill="#34495e">• デバイス紛失/侵害 • 権限変更 • セッション無効化</text>

    <!-- Vertical separator -->
    <line x1="500" y1="90" x2="500" y2="620" stroke="#bdc3c7" stroke-width="2" stroke-dasharray="5,5"/>

    <!-- Arrow markers definition -->
    <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7"
                refX="10" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
        </marker>
    </defs>

    <!-- Key concept box -->
    <rect x="50" y="620" width="900" height="60" fill="#ecf0f1" stroke="#95a5a6" stroke-width="1" rx="5"/>
    <text x="500" y="640" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50">
        CAEP = 継続的なアクセス評価により、セキュリティイベント発生時に即座にアクセス権を無効化
    </text>
    <text x="500" y="660" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#34495e">
        トークンの有効期限に関係なく、リアルタイムでセキュリティ状態を監視・制御する次世代認証プロトコル
    </text>
</svg>