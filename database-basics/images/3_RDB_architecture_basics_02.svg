<svg viewBox="0 0 900 600" xmlns="http://www.w3.org/2000/svg">
  <!-- 定義 -->
  <defs>
    <linearGradient id="clientGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4facfe;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#00f2fe;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="serverGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#fa709a;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#fee140;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow">
      <feDropShadow dx="0" dy="3" stdDeviation="5" flood-opacity="0.2"/>
    </filter>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#333" />
    </marker>
  </defs>
  
  <!-- 背景 -->
  <rect width="900" height="600" fill="#f8f9fa"/>
  
  <!-- タイトル -->
  <text x="450" y="40" text-anchor="middle" fill="#2c3e50" font-size="28" font-weight="bold">
    クライアント・サーバー間の通信フロー
  </text>
  
  <!-- クライアント側 -->
  <g transform="translate(100, 100)">
    <rect width="200" height="400" fill="url(#clientGrad)" rx="20" filter="url(#shadow)"/>
    <text x="100" y="35" text-anchor="middle" fill="white" font-size="20" font-weight="bold">
      クライアント
    </text>
    
    <!-- ステップ -->
    <g transform="translate(20, 70)">
      <rect width="160" height="50" fill="white" rx="10" opacity="0.9"/>
      <text x="80" y="25" text-anchor="middle" font-size="14" fill="#2c3e50">1. 接続要求</text>
      <text x="80" y="40" text-anchor="middle" font-size="12" fill="#7f8c8d">認証情報送信</text>
    </g>
    
    <g transform="translate(20, 140)">
      <rect width="160" height="50" fill="white" rx="10" opacity="0.9"/>
      <text x="80" y="25" text-anchor="middle" font-size="14" fill="#2c3e50">2. SQL送信</text>
      <text x="80" y="40" text-anchor="middle" font-size="12" fill="#7f8c8d">SELECT, INSERT等</text>
    </g>
    
    <g transform="translate(20, 210)">
      <rect width="160" height="50" fill="white" rx="10" opacity="0.9"/>
      <text x="80" y="25" text-anchor="middle" font-size="14" fill="#2c3e50">3. 結果受信</text>
      <text x="80" y="40" text-anchor="middle" font-size="12" fill="#7f8c8d">結果セット処理</text>
    </g>
    
    <g transform="translate(20, 280)">
      <rect width="160" height="50" fill="white" rx="10" opacity="0.9"/>
      <text x="80" y="25" text-anchor="middle" font-size="14" fill="#2c3e50">4. 接続終了</text>
      <text x="80" y="40" text-anchor="middle" font-size="12" fill="#7f8c8d">リソース解放</text>
    </g>
  </g>
  
  <!-- サーバー側 -->
  <g transform="translate(600, 100)">
    <rect width="200" height="400" fill="url(#serverGrad)" rx="20" filter="url(#shadow)"/>
    <text x="100" y="35" text-anchor="middle" fill="white" font-size="20" font-weight="bold">
      サーバー
    </text>
    
    <!-- ステップ -->
    <g transform="translate(20, 70)">
      <rect width="160" height="50" fill="white" rx="10" opacity="0.9"/>
      <text x="80" y="25" text-anchor="middle" font-size="14" fill="#2c3e50">1. 接続受付</text>
      <text x="80" y="40" text-anchor="middle" font-size="12" fill="#7f8c8d">認証処理</text>
    </g>
    
    <g transform="translate(20, 140)">
      <rect width="160" height="50" fill="white" rx="10" opacity="0.9"/>
      <text x="80" y="25" text-anchor="middle" font-size="14" fill="#2c3e50">2. SQL解析</text>
      <text x="80" y="40" text-anchor="middle" font-size="12" fill="#7f8c8d">実行計画作成</text>
    </g>
    
    <g transform="translate(20, 210)">
      <rect width="160" height="50" fill="white" rx="10" opacity="0.9"/>
      <text x="80" y="25" text-anchor="middle" font-size="14" fill="#2c3e50">3. 実行・送信</text>
      <text x="80" y="40" text-anchor="middle" font-size="12" fill="#7f8c8d">結果セット生成</text>
    </g>
    
    <g transform="translate(20, 280)">
      <rect width="160" height="50" fill="white" rx="10" opacity="0.9"/>
      <text x="80" y="25" text-anchor="middle" font-size="14" fill="#2c3e50">4. 切断処理</text>
      <text x="80" y="40" text-anchor="middle" font-size="12" fill="#7f8c8d">セッション終了</text>
    </g>
  </g>
  
  <!-- 通信矢印 -->
  <!-- 接続要求 -->
  <g>
    <line x1="300" y1="195" x2="600" y2="195" stroke="#3498db" stroke-width="3" marker-end="url(#arrow)"/>
    <text x="450" y="190" text-anchor="middle" font-size="12" fill="#3498db">接続要求</text>
  </g>
  
  <!-- 接続確立 -->
  <g>
    <line x1="600" y1="215" x2="300" y2="215" stroke="#2ecc71" stroke-width="3" marker-end="url(#arrow)"/>
    <text x="450" y="230" text-anchor="middle" font-size="12" fill="#2ecc71">接続確立</text>
  </g>
  
  <!-- SQL送信 -->
  <g>
    <line x1="300" y1="265" x2="600" y2="265" stroke="#3498db" stroke-width="3" marker-end="url(#arrow)"/>
    <text x="450" y="260" text-anchor="middle" font-size="12" fill="#3498db">SQL文</text>
  </g>
  
  <!-- 結果返信 -->
  <g>
    <line x1="600" y1="285" x2="300" y2="285" stroke="#2ecc71" stroke-width="3" marker-end="url(#arrow)"/>
    <text x="450" y="300" text-anchor="middle" font-size="12" fill="#2ecc71">結果セット</text>
  </g>
  
  <!-- 切断 -->
  <g>
    <line x1="300" y1="405" x2="600" y2="405" stroke="#e74c3c" stroke-width="3" marker-end="url(#arrow)"/>
    <text x="450" y="400" text-anchor="middle" font-size="12" fill="#e74c3c">切断要求</text>
  </g>
  
  <!-- TCP/IP表示 -->
  <g transform="translate(450, 520)">
    <rect x="-80" y="-20" width="160" height="40" fill="#34495e" rx="20"/>
    <text x="0" y="5" text-anchor="middle" font-size="16" fill="white" font-weight="bold">
      TCP/IP
    </text>
  </g>
</svg>