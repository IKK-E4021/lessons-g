# 2. データベースの種類と選択

# はじめに

なぜ、私たちは様々なデータベースについて学ぶ必要があるのでしょうか？

現代のアプリケーション開発において、データはシステムの「心臓」です。そして、最適なデータベースを選ぶことは、建物の「基礎」を選ぶことに似ています。

もし選択を誤れば、システムが遅くなったり、拡張が困難になったり、扱いたいデータをうまく格納できなかったりする可能性があります。

この章では、主要なデータベースの種類とその特徴を学び、適材適所でデータベースを選択し、堅牢でスケーラブルなシステムを構築するための判断力を養います。

# 2.1. リレーショナルデータベース（RDB）の概要

## 2.1.1 RDBとは？
- 行と列からなる表形式でデータを管理するデータベース
- Excelの表をイメージすると分かりやすいです
- SQL（Structured Query Language）という言語でデータを操作します

## 2.1.2 特徴
- データの整合性を保証 (ACID特性)
  - Atomicity (原子性): トランザクションは全て成功 or 全て失敗
  - Consistency (一貫性): データは常に正しい状態を保つ
  - Isolation (独立性): 複数の処理が互いに影響しない
  - Durability (永続性): 一度完了した処理は失われない
- 事前に厳密なスキーマ（データの構造）を定義する必要がある


# 2.2. NoSQLデータベースの紹介

## 2.2.1 NoSQLとは？
"Not Only SQL" の略。RDB以外のデータベースの総称

## 2.2.2 登場背景
- インターネットの普及による爆発的なデータ量の増加（ビッグデータ）
- SNS、IoTなど、多様な形式のデータを扱う必要性が生まれた

## RDBとの大きな違い
- スキーマが柔軟（スキーマレス）: 事前に厳密な構造を決めなくてもデータを保存できる
- 水平分散（スケールアウト）が得意: サーバーの台数を増やすことで性能を向上させやすい


# 2.3. NoSQLデータベースの種類

## 2.3.1 ドキュメント型

### 概要
JSONやXMLのような、構造を持った「ドキュメント」をそのまま格納するデータベース。各ドキュメントは自己完結しており、RDBのように複数のテーブルに分割して格納する必要がありません。

### 特徴
- スキーマレスで柔軟なデータ構造に対応できるため、開発途中の仕様変更に強い
- ドキュメント単位での読み書きが得意
- Webアプリケーションでよく使われるJSONとの親和性が非常に高い

### ユースケース
Webサイトのコンテンツ管理、ECサイトの商品カタログ、ユーザープロファイル管理など

### 代表的な製品
- MongoDB: ドキュメント型NoSQLの代表格。豊富な機能と高い人気を誇る
- Amazon DocumentDB: AWSが提供するMongoDB互換のマネージドサービス

## 2.3.2 キーバリュー型 (KVS)

### 概要
「キー」と「値（バリュー）」という非常にシンプルなペアのみでデータを管理します。キーを指定すると、対応する値が一意に取得できます。

### 特徴
- 構造がシンプルなため、読み書きの速度が極めて高速
- スケールアウトが容易
- 複雑な検索やデータの関連付けは苦手

### ユースケース
Webアプリケーションのセッション管理、頻繁にアクセスされるデータのキャッシュ、リアルタイムランキングなど

### 代表的な製品
- Redis: インメモリ（データをメモリ上に格納）で動作するため超高速。キャッシュ用途で広く利用される
- Amazon DynamoDB: AWSが提供するフルマネージドのキーバリュー型およびドキュメント型データベース

## 2.3.3 カラム指向型 (ワイドカラムストア)

### 概要
RDBが行単位でデータを格納するのに対し、カラム（列）単位でデータを格納します。これにより、特定の列に対する集計や分析が高速になります。

### 特徴
- 大量の書き込み処理に非常に強い（Write-intensive）
- 列の追加や削除が容易で、柔軟なスキーマを持つ
- 特定の行の全データを取得するような処理は、RDBに比べて非効率になる場合がある

### ユースケース
IoTデバイスからのセンサーデータ、アクセスログ、メッセージングアプリの履歴など、時系列データの記録・分析

### 代表的な製品
- Apache Cassandra: Facebookが開発。高いスケーラビリティと可用性を誇る
- Google Cloud Bigtable: Googleが提供するフルマネージドのワイドカラムストア

## 2.3.４ グラフ型

### 概要
データそのものを「ノード（点）」、データ間の関連性を「エッジ（線）」として表現し、格納します。データ同士の「つながり」を効率的に扱うことに特化しています。

### 特徴
- RDBでは複雑なJOINが必要になるような、深い階層の関連性をたどるクエリが非常に高速
- データモデルが直感的で理解しやすい

### ユースケース
SNSの友人関係、経路検索（ナビゲーション）、不正検知、レコメンデーションエンジンなど

### 代表的な製品
- Neo4j: グラフ型データベースのリーダー的存在。専用のクエリ言語「Cypher」を持つ
- Amazon Neptune: AWSが提供するフルマネージドのグラフデータベースサービス

